# Магазин видеокарт - Описание этапов 3 и 4

## Этап 3: Реализация "слоя представления" - консоли

### Основные команды и их назначение

*   **1. Список видеокарт:**
    *   Выводит список всех видеокарт из базы данных с их ID, названием модели и ценой.
    *   Использует `VideoCardRepository.GetAllVideoCards()` для получения данных.

*   **2. Поиск видеокарты по названию:**
    *   Позволяет ввести часть названия видеокарты и выводит все видеокарты, содержащие эту подстроку в названии.
    *   Использует `VideoCardRepository.SearchVideoCardsByName(string name)` для поиска данных.

*   **3. Добавить видеокарту:**
    *   Запрашивает информацию о новой видеокарте (название модели, ID GPU, ID производителя, цена, частоты) и добавляет её в базу данных.
    *   Использует `VideoCardRepository.AddVideoCard(VideoCard videoCard)` для добавления данных.
    *   Выполняет проверку ввода данных:
        *   Проверка на корректность числовых значений (ID GPU, ID производителя, цена, частоты).
    *   Обрабатывает исключения, которые могут возникнуть при работе с базой данных.

*   **4. Редактировать видеокарту:**
    *   Позволяет изменить цену видеокарты по её ID.
    *   Использует `VideoCardRepository.GetVideoCardById(int id)` для получения данных и `VideoCardRepository.UpdateVideoCard(VideoCard videoCard)` для обновления данных.
    *   Выполняет проверку ввода данных:
        *   Проверка на корректность ID видеокарты и новой цены.
    *   Обрабатывает исключения, которые могут возникнуть при работе с базой данных.

*   **5. Удалить видеокарту:**
    *   Удаляет видеокарту из базы данных по её ID.
    *   Использует `VideoCardRepository.DeleteVideoCard(int id)` для удаления данных.
    *   Выполняет проверку ввода данных:
        *   Проверка на корректность ID видеокарты.
    *   Обрабатывает исключения, которые могут возникнуть при работе с базой данных.

*   **6. Список производителей:**
    *   Выводит список всех производителей из базы данных с их ID, названием и страной.
    *   Использует `ManufacturerRepository.GetAllManufacturers()` для получения данных.

*   **7. Выход:**
    *   Завершает работу программы.

### Обработка ввода пользователя

*   Выполняется проверка ввода данных перед выполнением операций с базой данных (например, проверка на числовые значения).
*   Используются блоки `try-catch` для обработки исключений, которые могут возникнуть при работе с базой данных (например, `SQLiteException`).
*   Пользователю выводятся информативные сообщения об ошибках.

## Этап 4: Реализация слоя работы с БД

### Структура слоя работы с БД

Слой работы с базой данных состоит из следующих компонентов:

*   **Модели данных (Data Models):** Представляют таблицы базы данных в виде классов C#. Каждый класс соответствует таблице, а свойства класса – столбцам таблицы.
    *   `VideoCard`: Представляет информацию о видеокарте (VideoCardID, GPUID, ModelName, ManufacturerID, Price, ClockSpeedMHz, BoostClockSpeedMHz).
    *   `Manufacturer`: Представляет информацию о производителе (ManufacturerID, Name, Country).

*   **Репозитории (Repositories):** Отвечают за выполнение операций CRUD (Create, Read, Update, Delete) с базой данных для конкретных моделей. Содержат методы для запроса данных, добавления, обновления и удаления записей.
    *   `VideoCardRepository`: Содержит методы для работы с таблицей `VideoCards`:
        *   `GetAllVideoCards()`: Возвращает список всех видеокарт.
        *   `GetVideoCardById(int id)`: Возвращает видеокарту по ID.
        *   `AddVideoCard(VideoCard videoCard)`: Добавляет новую видеокарту.
        *   `UpdateVideoCard(VideoCard videoCard)`: Обновляет информацию о видеокарте.
        *   `DeleteVideoCard(int id)`: Удаляет видеокарту по ID.
        *   `SearchVideoCardsByName(string name)`: Ищет видеокарты по части названия модели.
    *   `ManufacturerRepository`: Содержит методы для работы с таблицей `Manufacturers`:
        *   `GetAllManufacturers()`: Возвращает список всех производителей.
        *   `GetManufacturerById(int id)`: Возвращает производителя по ID.

### Принципы реализации

*   **Разделение ответственности:** Слой представления (ConsoleUI) не взаимодействует напрямую с базой данных. Вместо этого он использует репозитории для получения и изменения данных.
*   **Инкапсуляция:** Детали работы с базой данных (например, SQL-запросы) скрыты внутри репозиториев.
*   **Обработка ошибок:** Репозитории обрабатывают исключения, связанные с работой базы данных (например, `SQLiteException`), и пробрасывают их выше, чтобы слой представления мог их обработать.
*   **Использование моделей данных:** Данные извлекаются из базы данных и преобразуются в объекты моделей данных, которые затем передаются слою представления.

### Методы репозиториев

Репозитории содержат методы для выполнения операций CRUD (Create, Read, Update, Delete) с базой данных.

*   **Create:**
    *   `AddVideoCard(VideoCard videoCard)`: Добавляет новую видеокарту в таблицу `VideoCards`.

*   **Read:**
    *   `GetAllVideoCards()`: Возвращает список всех видеокарт из таблицы `VideoCards`.
    *   `GetVideoCardById(int id)`: Возвращает видеокарту с указанным ID из таблицы `VideoCards`.
    *   `SearchVideoCardsByName(string name)`: Возвращает список видеокарт, чье имя содержит указанную подстроку.

*   **Update:**
    *   `UpdateVideoCard(VideoCard videoCard)`: Обновляет информацию о существующей видеокарте в таблице `VideoCards`.

*   **Delete:**
    *   `DeleteVideoCard(int id)`: Удаляет видеокарту с указанным ID из таблицы `VideoCards`.

### Обработка ошибок

*   В репозиториях используются блоки `try-catch` для перехвата исключений, которые могут возникнуть при работе с базой данных (`SQLiteException`, `Exception`).
*   Информация об ошибках выводится в консоль, и исключения пробрасываются выше для обработки в слое представления.
*   Реализована логика обработки случая, когда видеокарта с указанным ID не найдена при выполнении операций обновления или удаления.

Эта структура позволяет отделить логику работы с базой данных от логики представления, что упрощает разработку, тестирование и поддержку приложения.
